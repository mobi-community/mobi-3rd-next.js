## app router(13버전 이후)

- 프레임워크인 nextjs는 라이브러리인 react와는 다르게 사용방법대로 코드를 작성해야 프레임워크가 개발자의 코드를 읽어서 동작시켜준다.
- nextjs에서 페이지 라우팅을 위해서 다음의 사용방법을 따라야한다.
  > 1.app 폴더아래 `page.tsx`를 생성해야 해당 폴더의 이름으로 경로를 생성해준다.
  > 2.url경로는 상위 폴더이름/하위폴더이름/순으로 생성된다.
- 별도의 경로설정을 해줄 필요없이 폴더를 생성하고 `page.tsx`라는 파일을 만들어주는 과정으로 경로를 생성해준다.<br>
  _(page router의 경우 page.tsx 를 생성해서 동일한 동작이가능하다.)_

## `<Link>`

- react에서는 useNavigate()함수를 이용해 페이지이동을 시켰다.
- nextjs는 프레임워크로서 next/Link에서 Link컴포넌트를 지원해준다.
- `<Link>` 와 `<a>`의 차이점?
  > - 둘다 `href={경로}`를 작성하면 페이지이동을 가능하게해준다. 하지만 a는 페이지전체를 reload시키는 반면 Link는 빌드시 저장된 주소로 이동할때 사용하며 페이지전체를 reload하지 않는다.
  > - Link는 빋르 후 에 a tag로 자동으로 변환된다.
  > - 따라서 Link는 내부 페이지 이동시에 사용하고 외부페이지로 이동시에는 a tag를 사용하는 편이며 Link태그를 사용할 것을 권장한다.
  >   _(13버전 이후에는 Link tag내부에 a tag로 감싸지않아도 된다.)_

## Dynamic Routing

- 위에서 살펴본 라우팅방식은 경로가 변하지않는 정적인 경우 사용했다. 만약 postid와같은 값에의해 경로에 표시되어야할 경우 Dynamic Routing을 사용한다.
- 폴더이름으 `[]` 감싸는 것으로 Dynamic Routing을 활용할 수 있으며 해당 폴더아래 `page.tsx`는 특정 props를 전달받는다.

```tsx
ex) [id] > page.tsx

const PostId = ({params:{id}})=> {

  return <>페이지구성 컴포넌트..</>
}

```

params라는 key에 id라는 key를 가진객체형태의 파라미터를 전달받는다.

- 이 외에 useRouter()를 사용해서 동적 경로의 파라미터를 받아오는 것도 가능함.
## layout
- 각경로폴더아래 layout.tsx를 생성하면 모든 경로에서 공유할 수 있는 layout을 만들 수 있다.
- nextjs가 빌드할때 layout을 먼저확인하고 후에 page를 로드하낟. 또한 layout은 최상위 layout부터 중첩된다.

## Loading, error, notfound

- `(Loading, error, notfound).tsx`를 app아래 폴더에 생성하면 loading중일때, error발생시, 틀린경로 접근시 보여줄 컴포넌트를 생성할 수 있다. 이름만맞춰서 컴포넌트를 생성하면 특정상황에 대비한 컴포넌트를 보여줄 수 있어 간편하다.

## suspense

- Loading.tsx를 사용하면 loading중일때 해당페이지 전체가 Loading컴포넌트로 보이게된다.
- 데이터를 불러오는 컴포넌트가 아닌경우는 화면에보여지고 진짜 로딩중인 컴포넌트에만 Loading 상태를 보이고 싶다면 간단하게 해당컴포넌트를 suspense로 감싸면 해결된다.

```tsx
<Suspense fallback={<h1>Loading Movie Info</h1>}>
  <MovieInfo id={id} />
</Suspense>
```

## use client

- nextjs는 ssr방식이기에 정적이 html을 생성후 클라이언트에게 보내준다. 하지만 user와 interaction이 있는 컴포넌트라면? 상단에 `use client`라는 keyword를 작성한다.
- 클라이언트 컴포넌트는 초기에 ssr방식에 의해 정적인 html을 사용자에게 보여주고 hydration과정을 거치며 eventlistener가 적용되서 클라이언트 컴포넌트가 된다.
- 따라서 페이지를 처음 방문하는 사용자는 페이지로딩중에 컴포넌트와 interaction하려해도 동작하진않지만 완전히 로드된후에는 실제로 컴포넌트에 event를 발생시킬 수 있다.
- 주의할 점은 부모컴포넌트가 client컴포넌트라면 자식컴포넌트또한 client컴포넌트가 되야한다.
  _(반대의 경우는 아니다)_

## metadata

- metadata는 페이지의 `<head>`부분에 포함되는 정보이다.
- 페이지의 제목과 설명을 설정할 수 있고 이를통해 SEO향상에 영향을 미칠 수 있다.
```tsx
export const metadata: Metadata = {
  title: {
    template: `%s | Next Movies`,
    default: "Next Movies",
  },
  description: "Generated by Next.js",
}
```
다음과 같이 metadata를 설정 할 수 있고 또한 동적 router에서는 
```tsx
export const generateMetadata = async ({ params: { id } }) => {

}

```
generateMetadat()함수를 통해 metadata를 설정할 수 있다.
_(server component일때만 metadata를 사용할 수 있다.)_

